# 慧感云瞻

## 目录
- [项目概述](#项目概述)
- [文档导航](#文档导航)
- [系统架构](#系统架构)
- [技术栈](#技术栈)
- [核心功能](#核心功能)
- [部署架构](#部署架构)


## 项目概述

慧感云瞻是一套基于边缘计算和人工智能的智慧校园解决方案，通过分布式架构实现校园内人员流量的实时监测、环境数据采集和智能分析。系统采用"云-边-端"三层架构，在保障数据隐私的前提下，提供高效、准确的人员检测和环境监控服务。

## 文档导航

| 模块 | 文档链接 | 主要内容 |
|------|----------|----------|
| 🖥️ **前端** | [前端文档](./front_end/readme.md) | Vue.js应用、组件设计、API服务层 |
| ⚙️ **后端** | [后端文档](./back_end/readme.md) | Django API、数据模型、WebSocket通信 |
| 🤖 **检测端** | [检测端文档](./detecting_end/readme.md) | YOLO检测、节点管理、系统监控 |
| 📷 **节点端** | [节点端文档](./node_end/readme.md) | ESP32-CAM、图像采集、传感器集成 |

### 系统特色
- **边缘计算优先**：本地化AI推理，减少网络传输，保护隐私安全
- **多模态数据融合**：集成人员检测、温湿度、CO2等多维度环境数据
- **实时响应**：WebSocket通信确保毫秒级数据更新和告警推送
- **灵活部署**：支持Push/Pull双工作模式，适应不同网络环境
- **可视化管理**：现代化Web界面，支持多终端访问和实时监控

## 系统架构

### 四层架构设计
```
┌─────────────────────────────────────────────────────────────┐
│                        云端服务层                              │
│  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐ │
│  │   Django后端    │  │   Vue.js前端    │  │   Nginx代理     │ │
│  │  REST API服务   │  │   管理界面      │  │   负载均衡      │ │
│  └─────────────────┘  └─────────────────┘  └─────────────────┘ │
└─────────────────────────────────────────────────────────────┘
│ WebSocket/HTTP
┌─────────────────────────────────────────────────────────────┐
│                        边缘计算层                              │
│  ┌─────────────────────────────────────────────────────────┐ │
│  │                   检测端 (树莓派5)                        │ │
│  │  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐      │ │
│  │  │ YOLO模型推理 │  │ 节点管理器   │  │ 环境监测     │      │ │
│  │  │ 人员检测     │  │ 多摄像头管理 │  │ CO2传感器   │      │ │
│  │  └─────────────┘  └─────────────┘  └─────────────┘      │ │
│  └─────────────────────────────────────────────────────────┘ │
└─────────────────────────────────────────────────────────────┘
│ HTTP/WebSocket
┌─────────────────────────────────────────────────────────────┐
│                        感知设备层                              │
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐          │
│  │ ESP32-CAM   │  │ ESP32-CAM   │  │ ESP32-CAM   │   ...    │
│  │ 摄像头节点1  │  │ 摄像头节点2  │  │ 摄像头节点N  │          │
│  │ 图像采集     │  │ 环境传感器   │  │ 状态监控     │          │
│  └─────────────┘  └─────────────┘  └─────────────┘          │
└─────────────────────────────────────────────────────────────┘
```

## 技术栈

### 前端技术栈
- **框架**: Vue 3 + TypeScript + Vite
- **UI组件**: Element Plus + ECharts + Leaflet
- **状态管理**: Pinia
- **网络通信**: Axios + Socket.io
- **工具库**: VueUse + Crypto-js

### 后端技术栈
- **框架**: Django 5.1.6 + Django REST Framework
- **数据库**: MySQL (生产) / SQLite (开发)
- **缓存**: Redis
- **消息队列**: Celery + Redis
- **实时通信**: Django Channels + WebSocket
- **认证**: JWT (Simple JWT)

### 检测端技术栈
- **语言**: Python 3.x
- **Web框架**: Flask
- **AI模型**: Ultralytics YOLO
- **图像处理**: OpenCV + NumPy
- **硬件通信**: I2C (SGP30传感器)
- **网络通信**: WebSocket + HTTP

### 节点端技术栈
- **硬件平台**: ESP32-CAM
- **开发环境**: Arduino IDE
- **网络协议**: WiFi + HTTP
- **图像格式**: JPEG
- **扩展传感器**: DHT22 (温湿度)

## 核心功能

### 🎯 人员检测
- **实时检测**: 基于YOLO模型的高精度人员识别
- **批量处理**: 支持多摄像头并发检测
- **双工作模式**: Push推送模式和Pull拉取模式
- **性能监控**: 检测精度统计和性能指标分析

### 🌡️ 环境监测
- **多参数采集**: 温度、湿度、CO2浓度实时监测
- **传感器管理**: SGP30、DHT22等多种传感器支持
- **数据融合**: 环境数据与人员数据关联分析
- **异常告警**: 环境参数超标自动告警

### 📊 数据管理
- **实时展示**: WebSocket推送实时数据更新
- **历史分析**: 时间序列数据存储和趋势分析
- **数据可视化**: ECharts图表展示和数据大屏
- **智能缓存**: Redis缓存优化数据访问性能

### 🔧 设备管理
- **远程控制**: WebSocket命令下发和状态监控
- **配置管理**: 摄像头参数远程配置
- **状态监控**: 设备在线状态和性能监控
- **日志管理**: 分布式日志收集和查询

### 🚨 告警系统
- **多级告警**: 支持火灾、安保、拥挤、健康等告警类型
- **智能推送**: 基于用户权限的告警推送
- **告警处理**: 告警确认、处理和历史记录
- **公告系统**: 系统公告发布和区域关联

### 👥 用户管理
- **角色权限**: 用户、工作人员、管理员三级权限
- **JWT认证**: 安全的Token认证机制
- **个人中心**: 用户信息管理和收藏功能
- **操作审计**: 用户操作日志和权限控制

## 部署架构

### 生产环境部署
```
┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐
│   Nginx代理     │    │   Django应用    │    │   MySQL数据库   │
│   静态文件服务   │────│   API服务       │────│   数据持久化     │
│   负载均衡      │    │   WebSocket服务 │    │   备份恢复      │
└─────────────────┘    └─────────────────┘    └─────────────────┘
│                       │                       │
└───────────────────────┼───────────────────────┘
│
┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐
│   Redis缓存     │    │   Celery队列    │    │   检测端集群     │
│   会话存储      │────│   异步任务      │────│   边缘计算      │
│   数据缓存      │    │   定时任务      │    │   AI推理       │
└─────────────────┘    └─────────────────┘    └─────────────────┘
```

### 网络通信
- **HTTP API**: RESTful接口，支持CRUD操作
- **WebSocket**: 实时双向通信，支持WSS安全连接
- **数据上传**: 检测结果和环境数据批量上传
- **命令下发**: 远程控制和配置更新

### 快速开始
1. **环境准备**: 安装Python 3.x、Node.js、MySQL/Redis
2. **后端部署**: 参考后端文档配置Django应用
3. **前端构建**: 参考前端文档构建Vue.js应用
4. **检测端配置**: 参考检测端文档部署AI检测服务
5. **节点端烧录**: 参考节点端文档配置ESP32-CAM设备

### 系统要求
- **服务器**: Ubuntu 20.04+ / CentOS 7+
- **硬件**: 4GB+ RAM, 50GB+ 存储空间
- **网络**: 千兆以太网，支持WiFi
- **设备**: ESP32-CAM模块，树莓派5 (推荐)